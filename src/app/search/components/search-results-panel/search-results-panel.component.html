<ng-container *ngIf="!(vehicleSelectionFacade.activeVehicleId$ | async); else loaderOrResults">
  <div class="mx-4 text-center">
    <img class="mw-100" src="images/vehicle-select.svg" />
    <h3>Please "Select Your Model" from the drop down menu to continue.</h3>
  </div>
</ng-container>

<ng-template #loaderOrResults>
  <mtr-horizontal-circles-loader
    class="align-self-center d-block"
    *ngIf="searchResultsFacade.loading$ | async; else searchResultsOrMessage"
  ></mtr-horizontal-circles-loader>
</ng-template>

<ng-template #searchResultsOrMessage>
  <div class="mx-4 text-center" *ngIf="!(hasSearchResultsInAllTab$ | async); else searchResultsOrLinkToAllTab">No search results found.</div>
</ng-template>

<ng-template #searchResultsOrLinkToAllTab>
  <div class="mx-4 text-center" *ngIf="!(hasItemsToDisplay$ | async); else articleList">
    No search results match the selected category.
    <br />
    <a [routerLink]="['/docs', filterTabAll]" [queryParamsHandling]="'merge'">View all results.</a>
  </div>
</ng-template>

<ng-template #articleList>
  <ng-container *ngIf="itemsToDisplay$ | async as itemsToDisplay">
    <div class="h-100">
      <ul
        class="nav flex-column flex-nowrap py-2"
        [class.full-screen]="layoutFacade.isLeftExpanded$ | async"
        *ngIf="(searchResultsFacade.activeId$ | async) || -1 as selectedArticleId"
      > 
        <!-- Use *ngIf instead of ngSwitch since ngSwitch has poor type checking https://github.com/angular/angular/issues/20780 (Angular 10) -->
        <ng-container *ngFor="let item of itemsToDisplay; trackBy: trackBy">
          <h6
            *ngIf="item.kind === 'BucketHeader'"
            class="bucket-header icon-arrow-down-thin clickable"
            [ngClass]="{ 'child-element': item.isChild === true }"
            [class.collapsed]="isCollapsedByBucket$.value[item.bucket]"
            (click)="toggleBucketState(item.bucket)"
          >
            {{ item.bucket }}
          </h6>
          <div
            class="d-flex flex-wrap"
            *ngIf="item.kind === 'ArticleDetailsList'"
            [ngClass]="{ 'child-element': item.isChild === true }"
            [class.flex-column]="!(layoutFacade.isLeftExpanded$ | async)"
          >
            <mtr-search-results-item
              *ngFor="let details of item.list"
              [ngClass]="{ 'child-element': item.isChild === true }"
              [isSelected]="selectedArticleId === details.id"
              [isFullScreen]="layoutFacade.isLeftExpanded$ | async"
              [details]="details"
              (click)="searchResultsFacade.activateArticle(details)"
            ></mtr-search-results-item>
          </div>
          <mtr-search-results-item
            *ngIf="item.kind === 'ArticleDetails'"
            [ngClass]="{ 'child-element': item.isChild === true }"
            [isSelected]="selectedArticleId === item.details.id"
            [isFullScreen]="layoutFacade.isLeftExpanded$ | async"
            [details]="item.details"
            (click)="searchResultsFacade.activateArticle(item.details)"
          ></mtr-search-results-item>
          <button
            *ngIf="item.kind === 'BucketShowAll'"
            [ngClass]="{ 'child-element': item.isChild === true }"
            class="btn btn-link"
            (click)="showAll(item.bucket)"
          >
            Show all {{ item.count }} {{ item.bucket }}...
          </button>
        </ng-container>
      </ul>
    </div>
  </ng-container>
</ng-template>
